(()=>{"use strict";const e=[[{en:"1",ru:"1",code:"Digit1",shiftValue:"!"},{en:"2",ru:"2",code:"Digit2",shiftValue:"@"},{en:"3",ru:"3",code:"Digit3",shiftValue:"#"},{en:"4",ru:"4",code:"Digit4",shiftValue:"$"},{en:"5",ru:"5",code:"Digit5",shiftValue:"%"},{en:"6",ru:"6",code:"Digit6",shiftValue:"^"},{en:"7",ru:"7",code:"Digit7",shiftValue:"&"},{en:"8",ru:"8",code:"Digit8",shiftValue:"*"},{en:"9",ru:"9",code:"Digit9",shiftValue:"("},{en:"0",ru:"0",code:"Digit0",shiftValue:")"},{en:"-",ru:"-",code:"Minus",shiftValue:"_"},{en:"=",ru:"=",code:"Equal",shiftValue:"+"},{en:"backspace",ru:"backspace",code:"Backspace"}],[{en:"keyboard_tab",ru:"keyboard_tab",code:"Tab"},{en:"q",ru:"й",code:"KeyQ"},{en:"w",ru:"ц",code:"KeyW"},{en:"e",ru:"у",code:"KeyE"},{en:"r",ru:"к",code:"KeyR"},{en:"t",ru:"е",code:"KeyT"},{en:"y",ru:"н",code:"KeyY"},{en:"u",ru:"г",code:"KeyU"},{en:"i",ru:"ш",code:"KeyI"},{en:"o",ru:"щ",code:"KeyO"},{en:"p",ru:"з",code:"KeyP"},{en:"[",ru:"х",code:"BracketLeft",shiftValue:"{"},{en:"]",ru:"ъ",code:"BracketRight",shiftValue:"}"},{en:"\\",ru:"ё",code:"Backslash",shiftValue:"|"}],[{en:"keyboard_capslock",ru:"keyboard_capslock",code:"CapsLock"},{en:"a",ru:"ф",code:"KeyA"},{en:"s",ru:"ы",code:"KeyS"},{en:"d",ru:"в",code:"KeyD"},{en:"f",ru:"а",code:"KeyF"},{en:"g",ru:"п",code:"KeyG"},{en:"h",ru:"р",code:"KeyH"},{en:"j",ru:"о",code:"KeyJ"},{en:"k",ru:"л",code:"KeyK"},{en:"l",ru:"д",code:"KeyL"},{en:";",ru:"ж",code:"Semicolon",shiftValue:":"},{en:"'",ru:"э",code:"Quote",shiftValue:'"'},{en:"keyboard_return",ru:"keyboard_return",code:"Enter"}],[{en:"arrow_upward",ru:"arrow_upward",code:"ShiftLeft"},{en:"`",ru:"]",code:"IntlBackslash",shiftValue:"~"},{en:"z",ru:"я",code:"KeyZ"},{en:"x",ru:"ч",code:"KeyX"},{en:"c",ru:"с",code:"KeyC"},{en:"v",ru:"м",code:"KeyV"},{en:"b",ru:"и",code:"KeyB"},{en:"n",ru:"т",code:"KeyN"},{en:"m",ru:"ь",code:"KeyM"},{en:",",ru:"б",code:"Comma",shiftValue:"<"},{en:".",ru:"ю",code:"Period",shiftValue:">"},{en:"/",ru:"/",code:"Slash",shiftValue:"?"},{en:"expand_less",ru:"expand_less",code:"ArrowUp"},{en:"arrow_upward",ru:"arrow_upward",code:"ShiftRight"}],[{en:"language",ru:"language",code:"Fn"},{en:"keyboard_control_key",ru:"keyboard_control_key",code:"ControlLeft"},{en:"keyboard_option_key",ru:"keyboard_option_key",code:"AltLeft"},{en:"keyboard_command_key",ru:"keyboard_command_key",code:"MetaLeft"},{en:"space_bar",ru:"space_bar",code:"Space"},{en:"keyboard_command_key",ru:"keyboard_command_key",code:"MetaRight"},{en:"keyboard_option_key",ru:"keyboard_option_key",code:"AltRight"},{en:"chevron_left",ru:"chevron_left",code:"ArrowLeft"},{en:"expand_more",ru:"expand_more",code:"ArrowDown"},{en:"chevron_right",ru:"chevron_right",code:"ArrowRight"}]],t=[],n=document.createElement("h1");n.className="title",n.innerHTML="macOS Virtual Keyboard (en-ru)",document.body.prepend(n);const a=document.createElement("textarea");a.className="textarea",n.after(a);const o=document.createElement("p");function s(e,t){"arrow_upward"===e.target.textContent&&t.handleShift()}o.className="subtitle",o.innerHTML='Click <i class="material-symbols-outlined">language</i> or press Ctrl+Option to change the language',n.after(o);class r{lang=JSON.parse(window.localStorage.getItem("lang"))||"en";elements={keyboard:null,keysContainer:null,keys:[]};capsLock=!1;initialize(){const e=document.getElementsByClassName("keyboard")[0];e&&(e.remove(),this.elements.keys=[],this.keyboard=null,this.keysContainer=null),this.elements.keyboard=document.createElement("div"),this.elements.keyboard.className="keyboard",this.elements.keyboard.addEventListener("mousedown",(e=>function(e,n){const o=n;"language"===e.target.textContent&&(o.lang="ru"===o.lang?"en":"ru",window.localStorage.setItem("lang",JSON.stringify(o.lang)),o.initialize()),e.target.classList.contains("keyboard__key")&&(t.includes(e.target)?("space_bar"===e.target.textContent&&(a.textContent+=" "),"keyboard_tab"===e.target.textContent&&(a.textContent+="    "),"keyboard_return"===e.target.textContent&&(a.textContent+="\n"),"backspace"===e.target.textContent&&(a.textContent=a.textContent.substring(0,a.textContent.length-1)),"keyboard_capslock"===e.target.textContent&&(o.capsLock=!o.capsLock,o.handleCapslock()),"chevron_left"===e.target.textContent&&(a.textContent+="↽"),"chevron_right"===e.target.textContent&&(a.textContent+="⇁"),"expand_more"===e.target.textContent&&(a.textContent+="⇂"),"expand_less"===e.target.textContent&&(a.textContent+="↾"),a.textContent+=""):a.textContent+=e.target.textContent)}(e,this))),this.elements.keyboard.addEventListener("mousedown",(e=>s(e,this))),this.elements.keyboard.addEventListener("mouseup",(e=>s(e,this))),a.after(this.elements.keyboard),this.elements.keysContainer=document.createElement("div"),this.elements.keysContainer.className="keyboard__keys",this.elements.keyboard.prepend(this.elements.keysContainer),this.elements.keysContainer.append(...this.createKeys()),this.elements.keys.forEach((e=>{e.addEventListener("mousedown",(()=>{e.classList.add("keyboard__key--active")})),e.addEventListener("mouseup",(()=>{e.classList.remove("keyboard__key--active")}))}))}createKeys(){let n;return e.map((e=>{const a=document.createElement("div");return a.classList.add("row"),e.forEach((e=>{const o=e;e[this.lang].length<2&&(this.capsLock?o[this.lang]=e[this.lang].toUpperCase():o[this.lang]=e[this.lang].toLowerCase()),n=new class{constructor(e){this.keyValue=e}generateKeys(){const e=document.createElement("div");return e.className="keyboard__key",e.innerHTML=this.keyValue,"space_bar"===this.keyValue&&e.classList.add("keyboard__key--extra-wide"),this.keyValue.length>2&&e.classList.add("material-symbols-outlined"),!(this.keyValue.length>2)||this.keyValue.includes("chevron")||this.keyValue.includes("expand")||this.keyValue.includes("command")||this.keyValue.includes("option")||this.keyValue.includes("language")||this.keyValue.includes("control")||e.classList.add("keyboard__key--wide"),e}}(e[this.lang]).generateKeys(),n.classList.add(e.code),e.shiftValue&&(n.classList.add("shiftValue"),n.setAttribute("data-shiftvalue",e.shiftValue)),n.classList.contains("material-symbols-outlined")&&t.push(n),this.elements.keys.push(n),a.append(n)})),a}))}toggleCapslock(e){e.getModifierState("CapsLock")?this.capsLock=!0:this.capsLock=!1}handleCapslock(){this.elements.keys.forEach((e=>{const n=e;t.includes(n)||(this.capsLock?n.textContent=n.textContent.toUpperCase():n.textContent=n.textContent.toLowerCase())}))}toggleShift(e){"Shift"===e.key&&this.handleShift()}handleShift(){this.elements.keys.forEach((e=>{const n=e;if(!t.includes(n)){if(n.classList.contains("shiftValue")){const e=n.getAttribute("data-shiftvalue");return n.dataset.shiftvalue=n.textContent,void(n.textContent=e)}n.textContent=n.textContent===n.textContent.toUpperCase()?n.textContent.toLowerCase():n.textContent.toUpperCase()}}))}changeLanguageByKeyboard(e){("Control"===e.key&&e.altKey||"Alt"===e.key&&e.ctrlKey)&&(this.lang="ru"===this.lang?"en":"ru",window.localStorage.setItem("lang",JSON.stringify(this.lang)),this.initialize())}static getKeyValueByCode(e,n){const a=document.querySelector(`.${n}`);return a.classList.add("keyboard__key--active"),t.includes(a)?"Space"===e.code?" ":"Tab"===e.code?"    ":"Enter"===e.code?"\n":"ArrowLeft"===e.code?"↽":"ArrowRight"===e.code?"⇁":"ArrowDown"===e.code?"⇂":"ArrowUp"===e.code?"↾":"":a.textContent}}const c=new r;c.initialize(),a.addEventListener("keydown",(e=>{e.preventDefault()})),window.addEventListener("keydown",(e=>{c.changeLanguageByKeyboard(e),c.toggleShift(e),a.textContent+=r.getKeyValueByCode(e,e.code),"CapsLock"===e.code&&(c.toggleCapslock(e),c.handleCapslock()),"Backspace"===e.code&&(a.textContent=a.textContent.substring(0,a.textContent.length-1)),a.selectionStart=a.textContent.length})),window.addEventListener("keyup",(e=>{c.elements.keys.forEach((e=>{e.classList.remove("keyboard__key--active")})),c.toggleShift(e),"CapsLock"===e.code&&(c.toggleCapslock(e),c.handleCapslock())}))})();